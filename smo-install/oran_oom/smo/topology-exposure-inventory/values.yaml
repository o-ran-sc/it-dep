#  ============LICENSE_START===============================================
#  Copyright (C) 2024-2025 OpenInfra Foundation Europe. All rights reserved.
#  ========================================================================
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#  ============LICENSE_END=================================================
#

global:
  nodePortPrefixExt: 305
  # This is used by the postgres container
  imageRegistry: "nexus3.o-ran-sc.org:10001"
  #Strimzi Kafka properties
  useStrimziKafka: true
  kafkaTopics:
    topologyIngestionTopic:
      name: &topologyIngestionTopic topology-inventory-ingestion

initsql:
  configmap:
    name: &sqlconfigmapname "topology-exposure-inventory-sql-init-config"

postgresql:
  image:
    debug: true
    repository: bitnamilegacy/postgresql
  auth:
    enablePostgresUser: true
    usePasswordFiles: true
    postgresPassword: teiv
    username: &dbusername topology_exposure_user
    password: &dbpassword dbpassword
    database: topology_exposure_db
  volumePermissions:
    enabled: true
    image:
      repository: bitnamilegacy/os-shell
  primary:
    initdb:
      scriptsConfigMap: *sqlconfigmapname
      user: postgres
      password: teiv
    persistence:
      size: 1Gi
      storageClass: pgsql-sc

topology-exposure:
  name: topology-exposure
  imagePullPolicy: IfNotPresent
  image:
    teiv:
      name: o-ran-sc/smo-teiv-exposure
      tag: 0.2.0
  service:
    type: ClusterIP
    ports:
    - name: http
      internalPort: "8080"
      targetPort: "8080"
  liveness:
    initialDelaySeconds: 60
    periodSeconds: 10
    # necessary to disable liveness probe when setting breakpoints
    # in debugger so K8s doesn't restart unresponsive container
    enabled: true
    port: http-api

  readiness:
    initialDelaySeconds: 60
    periodSeconds: 10
    port: http-api
  persistence:
    size: 2Gi
    storageClassName: standard
  kafkaUser:
    authenticationType: scram-sha-512
    acls:
      - name: topology-inventory-ingestion-consumer
        type: group
        operations: [Read]
      - name: *topologyIngestionTopic
        type: topic
        operations: [Create, Read, Write]


topology-ingestion:
  name: topology-ingestion
  imagePullPolicy: IfNotPresent
  image:
    teiv:
      name: o-ran-sc/smo-teiv-ingestion
      tag: 0.2.0
  service:
    type: ClusterIP
    ports:
    - name: http
      internalPort: "8080"
      targetPort: "8080"
  liveness:
    initialDelaySeconds: 60
    periodSeconds: 10
    # necessary to disable liveness probe when setting breakpoints
    # in debugger so K8s doesn't restart unresponsive container
    enabled: true
    port: http-api

  readiness:
    initialDelaySeconds: 60
    periodSeconds: 10
    port: http-api
  persistence:
    size: 2Gi
    storageClassName: standard
  # Strimzi Kafka config
  kafkaUser:
    authenticationType: scram-sha-512
    acls:
      - name: topology-inventory-ingestion-consumer
        type: group
        operations: [Read]
      - name: *topologyIngestionTopic
        type: topic
        operations: [Create, Read, Write]

  kafkaTopic:
    - name: *topologyIngestionTopic

ncmp-to-teiv-adapter:
  name: ncmp-to-teiv-adapter
  imagePullPolicy: IfNotPresent
  image:
    name: o-ran-sc/smo-ncmp-to-teiv-adapter
    tag: 0.0.1
  service:
    type: ClusterIP
    ports:
      - name: http
        internalPort: "8080"
        targetPort: "8080"
        port: 8080
  liveness:
    initialDelaySeconds: 20
    periodSeconds: 10
  readiness:
    initialDelaySeconds: 20
    periodSeconds: 10
  persistence:
    size: 2Gi
    storageClassName: standard
  kafkaUser:
    authenticationType: scram-sha-512
    acls:
      - name: *topologyIngestionTopic
        type: topic
        operations: [Write]

focom-to-teiv-adapter:
  name: focom-to-teiv-adapter
  imagePullPolicy: IfNotPresent
  image:
    name: o-ran-sc/smo-focom-to-teiv-adapter
    tag: 0.1.0
  service:
    type: ClusterIP
    ports:
      - name: http
        internalPort: "8080"
        targetPort: "8080"
        port: 8080
  liveness:
    initialDelaySeconds: 20
    periodSeconds: 10
  readiness:
    initialDelaySeconds: 20
    periodSeconds: 10
  persistence:
    size: 2Gi
    storageClassName: standard
  kafkaUser:
    authenticationType: scram-sha-512
    acls:
      - name: *topologyIngestionTopic
        type: topic
        operations: [Write]
  # Kubeconfig configuration for FOCOM and O2IMS clusters
  # Set enabled to true and provide kubeconfig YAML content as string
  kubeconfig:
    enabled: false
    focom: |
      apiVersion: v1
      kind: Config
      clusters:
      - cluster:
          certificate-authority-data: LS0tLS1CRUdJTi...
          server: https://focom-cluster-control-plane:6443
        name: focom-cluster
      contexts:
      - context:
          cluster: focom-cluster
          user: focom-admin
        name: focom-context
      current-context: focom-context
      users:
      - name: focom-admin
        user:
          client-certificate-data: LS0tLS1CRUdJTi...
          client-key-data: LS0tLS1CRUdJTi...
    o2ims: |
      apiVersion: v1
      kind: Config
      clusters:
      - cluster:
          certificate-authority-data: LS0tLS1CRUdJTi...
          server: https://kind-control-plane:6443
        name: o2ims-cluster
      contexts:
      - context:
          cluster: o2ims-cluster
          user: o2ims-admin
        name: o2ims-context
      current-context: o2ims-context
      users:
      - name: o2ims-admin
        user:
          client-certificate-data: LS0tLS1CRUdJTi...
          client-key-data: LS0tLS1CRUdJTi...
